<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="PLONK"><meta name="keywords" content="rust, rustlang, rust-lang, dusk_plonk"><title>dusk_plonk - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="https:&#x2F;&#x2F;dusk.network&#x2F;lib&#x2F;img&#x2F;favicon-16x16.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../dusk_plonk/index.html'><div class='logo-container rust-logo'><img src='https:&#x2F;&#x2F;lh3.googleusercontent.com&#x2F;SmwswGxtgIANTbDrCOn5EKcRBnVdHjmYsHYxLq2HZNXWCQ9-fZyaea-bNgdX9eR0XGSqiMFi=w128-h128-e365' alt='logo'></div></a><h2 class="location">Crate dusk_plonk</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.9.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all dusk_plonk's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li></ul></div><div id="sidebar-vars" data-name="dusk_plonk" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">dusk_plonk</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/dusk_plonk/lib.rs.html#7-95" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="plonk" class="section-header"><a href="#plonk">PLONK</a></h2>
<p><img src="https://github.com/dusk-network/plonk/workflows/Continuous%20integration/badge.svg" alt="Build Status" />
<a href="https://github.com/dusk-network/plonk"><img src="https://img.shields.io/badge/github-plonk-blueviolet?logo=github" alt="Repository" /></a>
<a href="https://docs.rs/plonk/"><img src="https://img.shields.io/badge/docs-plonk-blue?logo=rust" alt="Documentation" /></a></p>
<p><em>This is a pure Rust implementation of the PLONK proving system over BLS12-381</em></p>
<p>This library contains a modularised implementation of KZG10 as the default polynomial commitment scheme.</p>
<h3 id="usage" class="section-header"><a href="#usage">Usage</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">dusk_plonk::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">rand_core::OsRng</span>;

<span class="comment">// Implement a circuit that checks:</span>
<span class="comment">// 1) a + b = c where C is a PI</span>
<span class="comment">// 2) a &lt;= 2^6</span>
<span class="comment">// 3) b &lt;= 2^5</span>
<span class="comment">// 4) a * b = d where D is a PI</span>
<span class="comment">// 5) JubJub::GENERATOR * e(JubJubScalar) = f where F is a Public Input</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Debug</span>, <span class="ident">Default</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">TestCircuit</span> {
    <span class="ident">a</span>: <span class="ident">BlsScalar</span>,
    <span class="ident">b</span>: <span class="ident">BlsScalar</span>,
    <span class="ident">c</span>: <span class="ident">BlsScalar</span>,
    <span class="ident">d</span>: <span class="ident">BlsScalar</span>,
    <span class="ident">e</span>: <span class="ident">JubJubScalar</span>,
    <span class="ident">f</span>: <span class="ident">JubJubAffine</span>,
}

<span class="kw">impl</span> <span class="ident">Circuit</span> <span class="kw">for</span> <span class="ident">TestCircuit</span> {
    <span class="kw">const</span> <span class="ident">CIRCUIT_ID</span>: [<span class="ident">u8</span>; <span class="number">32</span>] <span class="op">=</span> [<span class="number">0xff</span>; <span class="number">32</span>];
    <span class="kw">fn</span> <span class="ident">gadget</span>(
        <span class="kw-2">&amp;mut</span> <span class="self">self</span>,
        <span class="ident">composer</span>: <span class="kw-2">&amp;mut</span> <span class="ident">TurboComposer</span>,
    ) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Error</span><span class="op">&gt;</span> {
        <span class="kw">let</span> <span class="ident">a</span> <span class="op">=</span> <span class="ident">composer</span>.<span class="ident">append_witness</span>(<span class="self">self</span>.<span class="ident">a</span>);
        <span class="kw">let</span> <span class="ident">b</span> <span class="op">=</span> <span class="ident">composer</span>.<span class="ident">append_witness</span>(<span class="self">self</span>.<span class="ident">b</span>);

        <span class="comment">// Make first constraint a + b = c</span>
        <span class="kw">let</span> <span class="ident">constraint</span> <span class="op">=</span> <span class="ident">Constraint::new</span>()
            .<span class="ident">left</span>(<span class="number">1</span>)
            .<span class="ident">right</span>(<span class="number">1</span>)
            .<span class="ident">public</span>(<span class="op">-</span><span class="self">self</span>.<span class="ident">c</span>)
            .<span class="ident">a</span>(<span class="ident">a</span>)
            .<span class="ident">b</span>(<span class="ident">b</span>);

        <span class="ident">composer</span>.<span class="ident">append_gate</span>(<span class="ident">constraint</span>);

        <span class="comment">// Check that a and b are in range</span>
        <span class="ident">composer</span>.<span class="ident">component_range</span>(<span class="ident">a</span>, <span class="number">1</span> <span class="op">&lt;</span><span class="op">&lt;</span> <span class="number">6</span>);
        <span class="ident">composer</span>.<span class="ident">component_range</span>(<span class="ident">b</span>, <span class="number">1</span> <span class="op">&lt;</span><span class="op">&lt;</span> <span class="number">5</span>);

        <span class="comment">// Make second constraint a * b = d</span>
        <span class="kw">let</span> <span class="ident">constraint</span> <span class="op">=</span> <span class="ident">Constraint::new</span>()
            .<span class="ident">mult</span>(<span class="number">1</span>)
            .<span class="ident">output</span>(<span class="number">1</span>)
            .<span class="ident">public</span>(<span class="op">-</span><span class="self">self</span>.<span class="ident">d</span>)
            .<span class="ident">a</span>(<span class="ident">a</span>)
            .<span class="ident">b</span>(<span class="ident">b</span>);

        <span class="ident">composer</span>.<span class="ident">append_gate</span>(<span class="ident">constraint</span>);

        <span class="kw">let</span> <span class="ident">e</span> <span class="op">=</span> <span class="ident">composer</span>.<span class="ident">append_witness</span>(<span class="self">self</span>.<span class="ident">e</span>);
        <span class="kw">let</span> <span class="ident">scalar_mul_result</span> <span class="op">=</span> <span class="ident">composer</span>
            .<span class="ident">component_mul_generator</span>(<span class="ident">e</span>, <span class="ident">dusk_jubjub::GENERATOR_EXTENDED</span>);
        <span class="comment">// Apply the constrain</span>
        <span class="ident">composer</span>.<span class="ident">assert_equal_public_point</span>(<span class="ident">scalar_mul_result</span>, <span class="self">self</span>.<span class="ident">f</span>);
        <span class="prelude-val">Ok</span>(())
    }

    <span class="kw">fn</span> <span class="ident">public_inputs</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">PublicInputValue</span><span class="op">&gt;</span> {
        <span class="macro">vec!</span>[<span class="self">self</span>.<span class="ident">c</span>.<span class="ident">into</span>(), <span class="self">self</span>.<span class="ident">d</span>.<span class="ident">into</span>(), <span class="self">self</span>.<span class="ident">f</span>.<span class="ident">into</span>()]
    }

    <span class="kw">fn</span> <span class="ident">padded_gates</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="ident">usize</span> {
        <span class="number">1</span> <span class="op">&lt;</span><span class="op">&lt;</span> <span class="number">11</span>
    }
}

<span class="comment">// Now let&#39;s use the Circuit we&#39;ve just implemented!</span>

<span class="kw">let</span> <span class="ident">pp</span> <span class="op">=</span> <span class="ident">PublicParameters::setup</span>(<span class="number">1</span> <span class="op">&lt;</span><span class="op">&lt;</span> <span class="number">12</span>, <span class="kw-2">&amp;mut</span> <span class="ident">OsRng</span>).<span class="ident">unwrap</span>();
<span class="comment">// Initialize the circuit</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">circuit</span> <span class="op">=</span> <span class="ident">TestCircuit::default</span>();
<span class="comment">// Compile the circuit</span>
<span class="kw">let</span> (<span class="ident">pk</span>, <span class="ident">vd</span>) <span class="op">=</span> <span class="ident">circuit</span>.<span class="ident">compile</span>(<span class="kw-2">&amp;</span><span class="ident">pp</span>).<span class="ident">unwrap</span>();
<span class="comment">// Prover POV</span>
<span class="kw">let</span> <span class="ident">proof</span> <span class="op">=</span> {
    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">circuit</span> <span class="op">=</span> <span class="ident">TestCircuit</span> {
        <span class="ident">a</span>: <span class="ident">BlsScalar::from</span>(<span class="number">20u64</span>),
        <span class="ident">b</span>: <span class="ident">BlsScalar::from</span>(<span class="number">5u64</span>),
        <span class="ident">c</span>: <span class="ident">BlsScalar::from</span>(<span class="number">25u64</span>),
        <span class="ident">d</span>: <span class="ident">BlsScalar::from</span>(<span class="number">100u64</span>),
        <span class="ident">e</span>: <span class="ident">JubJubScalar::from</span>(<span class="number">2u64</span>),
        <span class="ident">f</span>: <span class="ident">JubJubAffine::from</span>(
            <span class="ident">dusk_jubjub::GENERATOR_EXTENDED</span> <span class="op">*</span> <span class="ident">JubJubScalar::from</span>(<span class="number">2u64</span>),
        ),
    };
    <span class="ident">circuit</span>.<span class="ident">prove</span>(<span class="kw-2">&amp;</span><span class="ident">pp</span>, <span class="kw-2">&amp;</span><span class="ident">pk</span>, <span class="string">b&quot;Test&quot;</span>).<span class="ident">unwrap</span>()
};
<span class="comment">// Verifier POV</span>
<span class="kw">let</span> <span class="ident">public_inputs</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">PublicInputValue</span><span class="op">&gt;</span> <span class="op">=</span> <span class="macro">vec!</span>[
    <span class="ident">BlsScalar::from</span>(<span class="number">25u64</span>).<span class="ident">into</span>(),
    <span class="ident">BlsScalar::from</span>(<span class="number">100u64</span>).<span class="ident">into</span>(),
    <span class="ident">JubJubAffine::from</span>(
        <span class="ident">dusk_jubjub::GENERATOR_EXTENDED</span> <span class="op">*</span> <span class="ident">JubJubScalar::from</span>(<span class="number">2u64</span>),
    )
    .<span class="ident">into</span>(),
];
<span class="ident">TestCircuit::verify</span>(
    <span class="kw-2">&amp;</span><span class="ident">pp</span>,
    <span class="kw-2">&amp;</span><span class="ident">vd</span>,
    <span class="kw-2">&amp;</span><span class="ident">proof</span>,
    <span class="kw-2">&amp;</span><span class="ident">public_inputs</span>,
    <span class="string">b&quot;Test&quot;</span>,
).<span class="ident">unwrap</span>();</code></pre></div>
<h4 id="features" class="section-header"><a href="#features">Features</a></h4>
<p>This crate includes a variety of features which will briefly be explained below:</p>
<ul>
<li><code>alloc</code>: Enables the usage of an allocator and with it the capability of performing <code>Proof</code> constructions and 
verifications. Without this feature it <strong>IS NOT</strong> possible to prove or verify anything. 
Its absence only makes <code>dusk-plonk</code> export certain fixed-size data structures such as <code>Proof</code> which can be useful in no_std envoirments where we don’t have allocators either.</li>
<li><code>std</code>: Enables <code>std</code> usage as well as <code>rayon</code> parallelisation in some proving and verifying ops. 
It also uses the <code>std</code> versions of the elliptic curve deps, which utilises the <code>parallel</code> feature 
from <code>dusk-bls12-381</code>. By default, this is the feature that comes enabled with the crate.</li>
<li><code>trace</code>: Enables the Circuit debugger tooling. This is essentially the capability of using the 
<code>StandardComposer::check_circuit_satisfied</code> function. The function will output information about each circuit gate until 
one of the gates does not satisfy the equation, or there are no more gates. If there is an unsatisfied gate 
equation, the function will panic and return the gate number.</li>
<li><code>trace-print</code>: Goes a step further than <code>trace</code> and prints each <code>gate</code> component data, giving a clear overview of all the 
values which make up the circuit that we’re constructing. 
<strong>The recommended method is to derive the std output, and the std error, and then place them in text file 
which can be used to efficiently analyse the gates.</strong></li>
<li><code>canon</code>: Enables <code>canonical</code> serialisation for particular data structures, which is very useful in integrating
this library within the rest of the Dusk stack - especially for storage purposes.</li>
</ul>
<h3 id="documentation" class="section-header"><a href="#documentation">Documentation</a></h3>
<p>There are two main types of documentation in this repository:</p>
<ul>
<li>
<p><strong>Crate documentation</strong>. This provides info about all of the functions that the library provides, as well
as the documentation regarding the data structures that it exports. To check this, please feel free to go to
the <a href="https://docs.rs/dusk-plonk/">documentation page</a> or run <code>make doc</code> or <code>make doc-internal</code>.</p>
</li>
<li>
<p><strong>Notes</strong>. This is a specific subset of documentation which explains the key mathematical concepts
of PLONK and how they work with mathematical demonstrations. To check it, run <code>make doc</code> and open the resulting docs,
which will be located under <code>/target</code> with your browser.</p>
</li>
</ul>
<h3 id="performance" class="section-header"><a href="#performance">Performance</a></h3>
<p>Benchmarks taken on <code>Intel(R) Core(TM) i9-9900X CPU @ 3.50GHz</code>
For a circuit-size of <code>2^16</code> constraints/gates:</p>
<ul>
<li>Proving time: <code>5.46s</code></li>
<li>Verification time: <code>9.34ms</code>. <strong>(This time will not vary depending on the circuit-size.)</strong></li>
</ul>
<p>For more results, please run <code>cargo bench</code> to get a full report of benchmarks in respect of constraint numbers.</p>
<h3 id="acknowledgements" class="section-header"><a href="#acknowledgements">Acknowledgements</a></h3>
<ul>
<li>Reference implementation AztecProtocol/Barretenberg</li>
<li>FFT Module and KZG10 Module were taken and modified from zexe/zcash and scipr-lab, respectively.</li>
</ul>
<h3 id="licensing" class="section-header"><a href="#licensing">Licensing</a></h3>
<p>This code is licensed under Mozilla Public License Version 2.0 (MPL-2.0). Please see <a href="https://github.com/dusk-network/plonk/blob/master/LICENSE">LICENSE</a> for further info.</p>
<h3 id="about" class="section-header"><a href="#about">About</a></h3>
<p>Implementation designed by the <a href="https://dusk.network">dusk</a> team.</p>
<h3 id="contributing" class="section-header"><a href="#contributing">Contributing</a></h3>
<ul>
<li>If you want to contribute to this repository/project please, check <a href="https://github.com/dusk-network/plonk/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li>If you want to report a bug or request a new feature addition, please open an issue on this repository.
<a href="https://codecov.io/gh/dusk-network/plonk">
<img src="https://codecov.io/gh/dusk-network/plonk/branch/master/graph/badge.svg" />
</a>
<a href="https://travis-ci.com/dusk-network/plonk">
<img src="https://travis-ci.com/dusk-network/plonk.svg?branch=master" />
</a>
<a href="https://github.com/dusk-network/plonk">
<img alt="GitHub issues" src="https://img.shields.io/github/issues-raw/dusk-network/plonk?style=plastic">
</a>
<a href="https://github.com/dusk-network/plonk/blob/master/LICENSE">
<img alt="GitHub" src="https://img.shields.io/github/license/dusk-network/plonk?color=%230E55EF">
</a></li>
</ul>
<p>Permutations over Lagrange-bases for Oecumenical Noninteractive
arguments of Knowledge (PLONK) is a zero knowledge proof system.</p>
<p>This protocol was created by:</p>
<ul>
<li>Ariel Gabizon (Protocol Labs),</li>
<li>Zachary J. Williamson (Aztec Protocol)</li>
<li>Oana Ciobotaru</li>
</ul>
<p>This crate contains a pure-rust implementation done by the <a href="dusk.network">DuskNetwork
team</a> of this algorithm using as a reference implementation
this one done by the creators of the protocol:</p>
<p><a href="https://github.com/AztecProtocol/barretenberg/blob/master/barretenberg/src/aztec/plonk/">https://github.com/AztecProtocol/barretenberg/blob/master/barretenberg/src/aztec/plonk/</a></p>
<p>If you want to see library usage examples, please check:
<a href="https://github.com/dusk-network/plonk/tree/v0.1.0/examples">https://github.com/dusk-network/plonk/tree/v0.1.0/examples</a></p>
</div></details><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="circuit/index.html" title="dusk_plonk::circuit mod">circuit</a></div><div class="item-right docblock-short"><p>Tools &amp; traits for PLONK circuits</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="commitment_scheme/index.html" title="dusk_plonk::commitment_scheme mod">commitment_scheme</a></div><div class="item-right docblock-short"><p>Ideally we should cleanly abstract away the polynomial commitment scheme
We note that PLONK makes use of the linearisation technique
conceived in SONIC [Mary Maller].</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="constraint_system/index.html" title="dusk_plonk::constraint_system mod">constraint_system</a></div><div class="item-right docblock-short"><p>The constraint System module stores the implementation
of the PLONK Standard Composer, as well as the circuit
tools and abstractions, used by the Composer to generate,
build, preprocess circuits.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="error/index.html" title="dusk_plonk::error mod">error</a></div><div class="item-right docblock-short"><p>A collection of all possible errors encountered in PLONK.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="notes/index.html" title="dusk_plonk::notes mod">notes</a></div><div class="item-right docblock-short"><p>This module is a self contained file which explains
how PLONK and its protocol components work in our library.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="plonkup/index.html" title="dusk_plonk::plonkup mod">plonkup</a></div><div class="item-right docblock-short"><p>Module containing the plonkup works.
Plonkup is the protcol for using
precomputed and stored tables of values
for specific functions to determine the
output of gates within a circuit, without
computing them.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="prelude/index.html" title="dusk_plonk::prelude mod">prelude</a></div><div class="item-right docblock-short"><p>Collection of functions needed to use plonk library.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="proof_system/index.html" title="dusk_plonk::proof_system mod">proof_system</a></div><div class="item-right docblock-short"><p>Proving system</p>
</div></div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="dusk_plonk" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script>
</body></html>